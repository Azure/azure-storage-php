<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Windows Azure SDK for PHP</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link rel="stylesheet" href="../css/template.css" type="text/css"></link><script type="text/javascript" src="../js/jquery-1.4.2.min.js"></script><script type="text/javascript" src="../js/jquery.tools.min.js"></script><script type="text/javascript" src="../js/jquery-ui-1.8.2.custom.min.js"></script><script type="text/javascript" src="../js/template.js"></script></head><body><div id="content"><h1 class="file">Common\Middlewares\HistoryMiddleware.php</h1><div id="file-nav-box"><div id="file-nav-options">
              Show:
              <img src="../images/icons/visibility_public.png" alt="Public" id="show-public"></img><img src="../images/icons/visibility_protected.png" alt="Protected" id="show-protected"></img><img src="../images/icons/visibility_private.png" alt="Private" id="show-private"></img><span class="attribute" id="show-inherited">inherited</span></div><div id="file-nav-container"><ul id="file-nav"><li><a href="#classes"><img src="../images/icons/class.png" alt="Class" height="14"></img>
                          Classes
                      </a><ul><li><a href="#\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware">\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware</a></li></ul></li></ul><div style="clear: left;"></div></div><div id="file-nav-tab">
              Table of Contents
          </div></div><a name="top" class="anchor"></a><div id="file-description"><div xmlns:php="http://php.net/xsl" class="short-description">LICENSE: The MIT License (the "License")
you may not use this file except in compliance with the License.</div><div xmlns:php="http://php.net/xsl" class="long-description"><p>You may obtain a copy of the License at
<a href="https://github.com/azure/azure-storage-php/LICENSE">https://github.com/azure/azure-storage-php/LICENSE</a></p>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
<p>PHP version 5</p></div></div><dl class="file-info"><dt xmlns:php="http://php.net/xsl">Author</dt><dd xmlns:php="http://php.net/xsl"><a href="mailto:dmsh@microsoft.com">Azure Storage PHP SDK</a>
         
    </dd><dt xmlns:php="http://php.net/xsl">Category</dt><dd xmlns:php="http://php.net/xsl">Microsoft
         
    </dd><dt xmlns:php="http://php.net/xsl">Copyright</dt><dd xmlns:php="http://php.net/xsl">2017 Microsoft Corporation
         
    </dd><dt xmlns:php="http://php.net/xsl">License</dt><dd xmlns:php="http://php.net/xsl"><a href="https://github.com/azure/azure-storage-php/LICENSE">https://github.com/azure/azure-storage-php/LICENSE</a>
         
    </dd><dt xmlns:php="http://php.net/xsl">Link</dt><dd xmlns:php="http://php.net/xsl"><a href="https://github.com/azure/azure-storage-php">https://github.com/azure/azure-storage-php</a>
         
    </dd><dt xmlns:php="http://php.net/xsl">Package</dt><dd xmlns:php="http://php.net/xsl">MicrosoftAzure\Storage\Common\Middlewares
         
    </dd></dl><a name="classes" class="anchor"></a><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware" class="anchor"></a><h2 class="class">\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware<div class="to-top"><a href="#top">jump to top</a></div></h2><div class="class"><div class="description"></div><small class="package"><b>Package: </b>MicrosoftAzure\Storage\Common\Middlewares</small><div xmlns:php="http://php.net/xsl" class="short-description">This class provides the functionality to log the requests/options/responses.</div><div xmlns:php="http://php.net/xsl" class="long-description"><p>Logging large number of entries without providing a file path may exhaust
the memory.</p>
<p>The middleware should be pushed into client options if the logging is
intended to persist between different API calls.</p></div><dl class="class-info"><dt>Parent(s)</dt><dd><a href="../files/Common.Middlewares.MiddlewareBase.html#\MicrosoftAzure\Storage\Common\Middlewares\MiddlewareBase">\MicrosoftAzure\Storage\Common\Middlewares\MiddlewareBase</a></dd><dt xmlns:php="http://php.net/xsl">Author</dt><dd xmlns:php="http://php.net/xsl"><a href="mailto:dmsh@microsoft.com">Azure Storage PHP SDK</a>
         
    </dd><dt xmlns:php="http://php.net/xsl">Category</dt><dd xmlns:php="http://php.net/xsl">Microsoft
         
    </dd><dt xmlns:php="http://php.net/xsl">Copyright</dt><dd xmlns:php="http://php.net/xsl">2017 Microsoft Corporation
         
    </dd><dt xmlns:php="http://php.net/xsl">Inherited_from</dt><dd xmlns:php="http://php.net/xsl"><a href="../files/
                         /classes/MicrosoftAzure.Storage.Common.Middlewares.MiddlewareBase.html">\MicrosoftAzure\Storage\Common\Middlewares\MiddlewareBase</a>
         
    </dd><dt xmlns:php="http://php.net/xsl">License</dt><dd xmlns:php="http://php.net/xsl"><a href="https://github.com/azure/azure-storage-php/LICENSE">https://github.com/azure/azure-storage-php/LICENSE</a>
         
    </dd><dt xmlns:php="http://php.net/xsl">Link</dt><dd xmlns:php="http://php.net/xsl"><a href="https://github.com/azure/azure-storage-php">https://github.com/azure/azure-storage-php</a>
         
    </dd></dl><h3>Constants</h3><div><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware::TITLE_LENGTH" class="anchor"></a><div class="constant publicC"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png" alt="&gt;"></img><img src="../images/icons/arrow_down.png" alt="V" style="display: none;"></img></a><code class="title"><img src="../images/icons/constant.png" alt="Constant"></img> 
                <span class="highlight">TITLE_LENGTH</span>
                = 120</code><div class="description"></div><div class="code-tabs"><div xmlns:php="http://php.net/xsl" class="long-description"></div></div><div class="clear"></div></div></div><h3>Methods</h3><div><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware::__construct()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">__construct</span><span class="nb-faded-text">(string $path = '')</span> : void</code><div class="description"><p class="short_description">Constructor</p></div><div class="code-tabs"><div xmlns:php="http://php.net/xsl" class="long-description"></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$path</th><td>string</td><td><em><p>the path to save the history. If path is provided,
                    no data is going to be saved to memory and the
                    entries are going to be serialized and saved to given
                    path.</p></em></td></tr></table></div><div class="clear"></div></div><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware::__invoke()" class="anchor"></a><div class="method public inherited_from "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">__invoke</span><span class="nb-faded-text">(callable $handler)</span> : callable</code><div class="description"><span class="attribute">inherited</span><p class="short_description">Middleware augments the functionality of handlers by invoking them
in the process of generating responses. And it returns a function
that accepts the next handler to invoke. Refer to
http://docs.guzzlephp.org/en/latest/handlers-and-middleware.html#middleware
for more detailed information.</p><small class="inherited_from">Inherited from:
                    <a href="../files//classes/MicrosoftAzure.Storage.Common.Middlewares.IMiddleware.html#method___invoke">\MicrosoftAzure\Storage\Common\Middlewares\IMiddleware::__invoke()</a></small></div><div class="code-tabs"><div xmlns:php="http://php.net/xsl" class="long-description"><pre><code>return function (
   RequestInterface $request,
   array $options
) use ($handler) {
   //do something prior to sending the request.
   $promise = $handler($request, $options);
   return $promise-&gt;then(
       function (ResponseInterface $response) use ($request, $options) {
           //do something
           return $response;
       },
       function ($reason) use ($request, $options) {
           //do something
           return new GuzzleHttp\Promise\RejectedPromise($reason);
       }
   );
};</code></pre></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$handler</th><td>callable</td><td><em><p>The handler function.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>callable</td><td>The function that accepts the next handler to invoke.</td></tr></table></div><div class="clear"></div></div><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware::addHistory()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">addHistory</span><span class="nb-faded-text">(array $entry)</span> : void</code><div class="description"><p class="short_description">Add an entry to history</p></div><div class="code-tabs"><div xmlns:php="http://php.net/xsl" class="long-description"></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$entry</th><td>array</td><td><em><p>the entry to be added.</p></em></td></tr></table></div><div class="clear"></div></div><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware::clearHistory()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">clearHistory</span><span class="nb-faded-text">()</span> : void</code><div class="description"><p class="short_description">Clear the history</p></div><div class="code-tabs"><div xmlns:php="http://php.net/xsl" class="long-description"></div></div><div class="clear"></div></div><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware::getHistory()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">getHistory</span><span class="nb-faded-text">()</span> : array</code><div class="description"><p class="short_description">Gets the saved paried history.</p></div><div class="code-tabs"><div xmlns:php="http://php.net/xsl" class="long-description"></div><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>array</td><td></td></tr></table></div><div class="clear"></div></div><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware::onFulfilled()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">onFulfilled</span><span class="nb-faded-text">(\Psr\Http\Message\RequestInterface $request, array $options)</span> : callable</code><div class="description"><p class="short_description">This function will be invoked after the request is sent, if
the promise is fulfilled.</p></div><div class="code-tabs"><div xmlns:php="http://php.net/xsl" class="long-description"></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$request</th><td>\Psr\Http\Message\RequestInterface</td><td><em><p>the request sent.</p></em></td></tr><tr><th>$options</th><td>array</td><td><em><p>the options that the request sent with.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>callable</td><td></td></tr></table></div><div class="clear"></div></div><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware::onFulfilled()" class="anchor"></a><div class="method protected inherited_from "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">onFulfilled</span><span class="nb-faded-text">(\Psr\Http\Message\RequestInterface $request, array $options)</span> : callable</code><div class="description"><span class="attribute">inherited</span><p class="short_description">This function will be invoked after the request is sent, if
the promise is fulfilled.</p><small class="inherited_from">Inherited from:
                    </small></div><div class="code-tabs"><div xmlns:php="http://php.net/xsl" class="long-description"></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$request</th><td>\Psr\Http\Message\RequestInterface</td><td><em><p>the request sent.</p></em></td></tr><tr><th>$options</th><td>array</td><td><em><p>the options that the request sent with.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>callable</td><td></td></tr></table></div><div class="clear"></div></div><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware::onRejected()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">onRejected</span><span class="nb-faded-text">(\Psr\Http\Message\RequestInterface $request, array $options)</span> : callable</code><div class="description"><p class="short_description">This function will be executed after the request is sent, if
the promise is rejected.</p></div><div class="code-tabs"><div xmlns:php="http://php.net/xsl" class="long-description"></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$request</th><td>\Psr\Http\Message\RequestInterface</td><td><em><p>the request sent.</p></em></td></tr><tr><th>$options</th><td>array</td><td><em><p>the options that the request sent with.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>callable</td><td></td></tr></table></div><div class="clear"></div></div><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware::onRejected()" class="anchor"></a><div class="method protected inherited_from "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">onRejected</span><span class="nb-faded-text">(\Psr\Http\Message\RequestInterface $request, array $options)</span> : callable</code><div class="description"><span class="attribute">inherited</span><p class="short_description">This function will be executed after the request is sent, if
the promise is rejected.</p><small class="inherited_from">Inherited from:
                    </small></div><div class="code-tabs"><div xmlns:php="http://php.net/xsl" class="long-description"></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$request</th><td>\Psr\Http\Message\RequestInterface</td><td><em><p>the request sent.</p></em></td></tr><tr><th>$options</th><td>array</td><td><em><p>the options that the request sent with.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>callable</td><td></td></tr></table></div><div class="clear"></div></div><a id="\MicrosoftAzure\Storage\Common\Middlewares\HistoryMiddleware::onRequest()" class="anchor"></a><div class="method protected inherited_from "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">onRequest</span><span class="nb-faded-text">(\Psr\Http\Message\RequestInterface $request)</span> : \Psr\Http\Message\RequestInterface</code><div class="description"><span class="attribute">inherited</span><p class="short_description">This function will be executed before the request is sent.</p><small class="inherited_from">Inherited from:
                    </small></div><div class="code-tabs"><div xmlns:php="http://php.net/xsl" class="long-description"></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$request</th><td>\Psr\Http\Message\RequestInterface</td><td><em><p>the request before altered.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>\Psr\Http\Message\RequestInterface</td><td>the request after altered.</td></tr></table></div><div class="clear"></div></div></div></div></div><small class="footer">
            Documentation was generated by
            <a href="http://phpdoc.org">phpDocumentor
                2.9.1</a>.
        </small></body></html>
